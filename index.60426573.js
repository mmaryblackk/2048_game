const t=new class{constructor(t){this.size=4,this.score=0,this.status="idle",this.board=t||this.createEmptyBoard()}createEmptyBoard(){return Array.from({length:this.size},()=>Array(this.size).fill(0))}moveLeft(){let t=!1;for(let e=0;e<this.size;e++){let s=this.board[e].filter(t=>0!==t);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,this.score+=s[t],s[t+1]=0);for(s=s.filter(t=>0!==t);s.length<this.size;)s.push(0);this.board[e].join(",")!==s.join(",")&&(t=!0),this.board[e]=s}return t&&this.afterMove(),t}moveRight(){this.board=this.board.map(t=>t.reverse());let t=this.moveLeft();return this.board=this.board.map(t=>t.reverse()),t}moveUp(){this.transpose();let t=this.moveLeft();return this.transpose(),t}moveDown(){this.transpose();let t=this.moveRight();return this.transpose(),t}transpose(){let t=this.createEmptyBoard();for(let e=0;e<this.size;e++)for(let s=0;s<this.size;s++)t[e][s]=this.board[s][e];this.board=t}getScore(){return this.score}getState(){return this.board.map(t=>[...t])}getStatus(){return this.status}start(){this.board=this.createEmptyBoard(),this.score=0,this.status="playing",this.addRandomTile(),this.addRandomTile()}restart(){this.start()}addRandomTile(){let t=[];for(let e=0;e<this.size;e++)for(let s=0;s<this.size;s++)0===this.board[e][s]&&t.push({r:e,c:s});if(0===t.length)return;let{r:e,c:s}=t[Math.floor(Math.random()*t.length)];this.board[e][s]=.9>Math.random()?2:4}afterMove(){this.addRandomTile(),this.checkWin()?this.status="win":this.movesAvailable()||(this.status="lose")}checkWin(){return this.board.some(t=>t.includes(2048))}movesAvailable(){for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++)if(0===this.board[t][e]||t<this.size-1&&this.board[t][e]===this.board[t+1][e]||e<this.size-1&&this.board[t][e]===this.board[t][e+1])return!0;return!1}},e=document.querySelector(".game-field"),s=document.querySelector(".game-score"),r=document.querySelector(".start"),i=document.querySelector(".message-start");function a(){let r=t.getState(),i=e.querySelectorAll(".field-cell");r.flat().forEach((t,e)=>{let s=i[e];s.className="field-cell",t?(s.textContent=t,s.classList.add(`field-cell--${t}`)):s.textContent=""}),s.textContent=t.getScore(),"win"===t.getStatus()?document.querySelector(".message-win").classList.remove("hidden"):"lose"===t.getStatus()&&document.querySelector(".message-lose").classList.remove("hidden")}r.addEventListener("click",()=>{r.classList.contains("start")?t.start():t.restart(),i&&i.classList.add("hidden"),document.querySelectorAll(".message").forEach(t=>t.classList.add("hidden")),a()}),document.addEventListener("keydown",e=>{if("playing"!==t.getStatus())return;let s=!1;switch(e.key){case"ArrowLeft":s=t.moveLeft();break;case"ArrowRight":s=t.moveRight();break;case"ArrowUp":s=t.moveUp();break;case"ArrowDown":s=t.moveDown();break;default:return}s&&r.classList.contains("start")&&(r.classList.remove("start"),r.classList.add("restart"),r.textContent="Restart"),a()});
//# sourceMappingURL=index.60426573.js.map
